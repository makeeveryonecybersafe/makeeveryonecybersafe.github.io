<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Mirror</title>
    <style>
        :root {
            --bg-color: #050505;
            --text-main: #cecece;
            --terminal-green: #33ff00;
            --alert-red: #ff3333;
            --highlight: #f0f0f0;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* CRT Scanline Effect */
        body::after {
            content: " ";
            display: block;
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 1000;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        #app-container {
            width: 90%;
            max-width: 600px;
            text-align: center;
            z-index: 10;
            position: relative;
        }

        h1 { font-size: 2.5rem; text-shadow: 0 0 5px var(--text-main); margin-bottom: 2rem; }
        
        button {
            background: transparent;
            border: 2px solid var(--text-main);
            color: var(--text-main);
            padding: 15px 30px;
            font-size: 1.2rem;
            font-family: inherit;
            cursor: pointer;
            transition: 0.3s;
        }
        button:hover { background: var(--text-main); color: var(--bg-color); box-shadow: 0 0 15px var(--text-main); }

        /* Utility Classes */
        .hidden { display: none !important; }
        .text-red { color: var(--alert-red); text-shadow: 0 0 5px red; }
        .text-green { color: var(--terminal-green); text-shadow: 0 0 5px green; }

        /* Quiz Styles */
        .quiz-btn { display: block; width: 100%; margin: 10px 0; border: 1px solid #555; }

        /* Analysis Text Lines */
        .analysis-line { margin: 20px 0; font-size: 1.1rem; opacity: 0; transition: opacity 1s ease-in; }

        /* Transition Phase */
        #transition-text h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-shadow: 0 0 8px white;
        }

        /* Auction / Easter Egg Styles */
        #auction-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: black; z-index: 5;
            display: flex; flex-direction: column;
        }

        #webcam-feed {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover;
            /* Sickly yellow filter */
            filter: sepia(100%) saturate(300%) hue-rotate(10deg) brightness(0.6) contrast(1.2);
            z-index: 1;
        }

        .no-footage {
            background: #0a0a0a;
            display: flex; align-items: center; justify-content: center;
            color: #333; font-size: 2rem; font-weight: bold;
            position: absolute; top:0; left:0; width:100%; height:100%;
            z-index: 1;
        }

        #auction-ui {
            position: relative; z-index: 10; height: 100%;
            display: flex; flex-direction: column; justify-content: space-between;
            padding: 20px; background: rgba(0,0,0,0.3);
        }

        #price-tag {
            align-self: center; font-size: 3.5rem; color: var(--alert-red);
            background: rgba(0,0,0,0.9); padding: 10px 20px;
            border: 2px solid var(--alert-red); margin-top: 50px;
            text-shadow: 0 0 10px red;
        }

        #chat-box {
            background: rgba(0, 0, 0, 0.9);
            height: 45%;
            overflow-y: auto;
            border-top: 2px solid var(--terminal-green);
            padding: 15px;
            font-size: 0.95rem;
            text-align: left;
            box-shadow: 0 -5px 20px rgba(0,0,0,1);
        }

        .chat-msg { margin-bottom: 8px; line-height: 1.4; }
        .bidder { color: #aaa; }
        .host { color: var(--alert-red); font-weight: bold; text-transform: uppercase; }
        .bid-msg { color: var(--terminal-green); border-bottom: 1px solid #333; padding-bottom: 2px; }

        #sold-stamp {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
            font-size: 6rem; color: red; border: 8px solid red;
            padding: 20px; font-weight: bold; opacity: 0;
            pointer-events: none; z-index: 100;
            text-shadow: 0 0 20px black;
            background: rgba(0,0,0,0.5);
        }

        /* Screen On Animation */
        @keyframes screenOn {
            0% { transform: scaleY(0.005) scaleX(0); background: #fff; }
            50% { transform: scaleY(0.005) scaleX(1); background: #fff; }
            100% { transform: scaleY(1) scaleX(1); background: transparent; }
        }
    </style>
</head>
<body>

    <div id="app-container">
        
        <section id="intro">
            <h1>DIGITAL MIRROR</h1>
            <button id="btn-begin">BEGIN</button>
            <p style="margin-top:20px; font-size: 0.8rem; color:#555;">(Sound Recommended)</p>
        </section>

        <section id="quiz" class="hidden">
            <h2 id="q-text">Question Text</h2>
            <div id="q-options">
                <button class="quiz-btn" onclick="handleAnswer(true)">YES</button>
                <button class="quiz-btn" onclick="handleAnswer(false)">NO</button>
            </div>
            <p id="q-progress">1/15</p>
        </section>

        <section id="analysis" class="hidden">
            <div id="analysis-content"></div>
        </section>

        <section id="transition" class="hidden">
            <div id="transition-text"></div>
        </section>

        <section id="outro" class="hidden">
            <h2 class="text-green">TRANSACTION COMPLETE</h2>
            <h1 id="final-price" class="text-red">$0.00</h1>
            <h3>ESTIMATED DARK WEB VALUE</h3>
            <hr style="border-color:#333; width: 50%;">
            <p>That is all you are worth to them.</p>
            <p>Your location, your habits, and your identity are often sold for less than the price of a lunch.</p>
            <p>This transaction happens thousands of times a day.</p>
            <br>
            <p style="font-size: 0.7rem; color: #555; border: 1px solid #333; padding: 10px;">
                NOTE: No data was actually saved. The device fingerprint shown was fetched locally from your browser, just as any website on the internet can do.
            </p>
            <button onclick="location.reload()" style="margin-top: 20px;">RESET</button>
        </section>

    </div>

    <div id="auction-overlay" class="hidden">
        <video id="webcam-feed" autoplay playsinline muted></video>
        <div class="no-footage hidden" id="no-signal">[NO SIGNAL]</div>
        <div id="sold-stamp">SOLD</div>
        <div id="auction-ui">
            <div id="price-tag">$0.00</div>
            <div id="chat-box">
                <div class="chat-msg host">HOST: Establishing Secure Link...</div>
            </div>
        </div>
    </div>

    <script>
        // --- STATE MANAGEMENT ---
        const state = {
            camAllowed: false,
            score: 0,
            qIndex: 0,
            answers: [], // Stores user answers
            ip: "Fetching...",
            location: "Unknown",
            device: "",
            battery: "Unknown"
        };

        // --- DOM ELEMENTS ---
        const screens = {
            intro: document.getElementById('intro'),
            quiz: document.getElementById('quiz'),
            analysis: document.getElementById('analysis'),
            transition: document.getElementById('transition'),
            outro: document.getElementById('outro'),
            auction: document.getElementById('auction-overlay')
        };

        const questions = [
            { t: "Do you use the same password for multiple accounts?", insecure: true, insult: "Uses one key for every door. Idiot." },
            { t: "Do you accept cookies without reading the prompt?", insecure: true, insult: "Accepts all cookies. They have no standards." },
            { t: "Is your date of birth public on social media?", insecure: true, insult: "DOB is public. Identity theft is too easy." },
            { t: "Do you have 2-Factor Authentication enabled?", insecure: false, insult: "No 2FA? They are practically begging for it." },
            { t: "Do you cover your webcam when not in use?", insecure: false, insult: "Lens was uncovered. Voyeur's paradise." },
            { t: "Do you click links in emails from unknown senders?", insecure: true, insult: "Clicks random links. A phishing dream." },
            { t: "Do you update your phone software immediately?", insecure: false, insult: "Running legacy software. Exploit ready." },
            { t: "Do you use free public Wi-Fi for banking?", insecure: true, insult: "Banking on Starbucks WiFi. Hilarious." },
            { t: "Do you allow apps to track your location always?", insecure: true, insult: "Location is always on. I know where they sleep." },
            { t: "Do you read the Terms & Conditions?", insecure: false, insult: "Doesn't read T&C. Signed their soul away." },
            { t: "Do you post photos of your boarding passes?", insecure: true, insult: "Posts boarding passes. Barcode reveals everything." },
            { t: "Do you use a password manager?", insecure: false, insult: "No password manager. Probably writes them on sticky notes." },
            { t: "Do you backup your data offline?", insecure: false, insult: "No backups. One ransomware attack and they're done." },
            { t: "Do you answer 'first pet' quizzes on FB?", insecure: true, insult: "Answers security questions on Facebook for fun." },
            { t: "Do you believe you are too boring to be hacked?", insecure: true, insult: "Thinks they are 'too boring' to hack. My favorite victim." },
        ];

        // --- PHASE 1: INTRO & PERMISSION ---
        document.getElementById('btn-begin').addEventListener('click', async () => {
            // Fetch Data
            state.device = navigator.userAgent;
            try {
                const batt = await navigator.getBattery();
                state.battery = Math.round(batt.level * 100) + "%";
            } catch(e) { state.battery = "Unknown"; }
            
            try {
                const res = await fetch('https://ipapi.co/json/');
                const data = await res.json();
                state.ip = data.ip || "Hidden";
                state.location = `${data.city}, ${data.country_name}` || "Unknown";
            } catch(e) {
                state.ip = "192.168.0.XX (Trace Blocked)";
                state.location = "Triangulating...";
            }

            // Camera Logic
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                document.getElementById('webcam-feed').srcObject = stream;
                state.camAllowed = true;
                nextScreen('intro', 'quiz');
                loadQuestion();
            } catch (err) {
                state.camAllowed = false;
                document.getElementById('webcam-feed').classList.add('hidden');
                document.getElementById('no-signal').classList.remove('hidden');
                nextScreen('intro', 'quiz');
                loadQuestion();
            }
        });

        // --- PHASE 2: QUIZ ---
        function loadQuestion() {
            if (state.qIndex >= questions.length) {
                finishQuiz();
                return;
            }
            const q = questions[state.qIndex];
            document.getElementById('q-text').innerText = q.t;
            document.getElementById('q-progress').innerText = `${state.qIndex + 1}/${questions.length}`;
        }

        function handleAnswer(bool) {
            state.answers.push(bool); // Store answer
            const q = questions[state.qIndex];
            if ((q.insecure && bool) || (!q.insecure && !bool)) {
                state.score++;
            }
            state.qIndex++;
            loadQuestion();
        }

        function nextScreen(curr, next) {
            screens[curr].classList.add('hidden');
            screens[next].classList.remove('hidden');
        }

        // --- PHASE 3: ANALYSIS ---
        function finishQuiz() {
            nextScreen('quiz', 'analysis');
            const container = document.getElementById('analysis-content');
            let lines = [];
            let scenario = ""; 

            const isSecure = state.score < 5; 
            
            if (isSecure && state.camAllowed) {
                scenario = "A";
                lines = [
                    "Analyzing answers...",
                    "Results: Highly Secure.",
                    "You spot the phishing.",
                    "But...",
                    `<span class='text-red'>You just allowed a random website to access your camera.</span>`,
                    "Logic failed you."
                ];
            } else if (!isSecure) {
                scenario = "B";
                lines = [
                    "Analyzing answers...",
                    "Results: <span class='text-red'>CRITICAL VULNERABILITY</span>",
                    "Your digital footprint is messy.",
                    "Passwords reused. Cookies accepted.",
                    "You are an open book."
                ];
            } else if (isSecure && !state.camAllowed) {
                scenario = "C";
                lines = [
                    "Analyzing answers...",
                    "Results: Secure.",
                    "Camera Access: <span class='text-red'>BLOCKED</span>",
                    "You think a piece of tape saves you.",
                    "<span class='text-red'>A Blocked Lens cannot stop us.</span>",
                    `IP: <span class='text-green'>${state.ip}</span>`,
                    `Location: <span class='text-green'>${state.location}</span>`,
                    `Device: ${state.device.substring(0, 20)}...`
                ];
            }

            let delay = 0;
            lines.forEach((line) => {
                const p = document.createElement('div');
                p.innerHTML = line;
                p.className = 'analysis-line';
                container.appendChild(p);
                setTimeout(() => { p.style.opacity = 1; }, delay);
                delay += 1500;
            });

            setTimeout(() => { startTransition(scenario); }, delay + 2000);
        }

        // --- PHASE 4: TRANSITION (PERSISTENT TEXT) ---
        function startTransition(scenario) {
            nextScreen('analysis', 'transition');
            const container = document.getElementById('transition-text');
            let poem = [];

            if (scenario === "A") {
                poem = ["It wasn't a hack.", "It was a permission.", "Allowed by the person.", "Staring at this screen."];
            } else if (scenario === "C") {
                poem = ["It wasn't a hack.", "It was a permission.", "Allowed by the person.", "Thinking they are safe behind a blocked lens."];
            } else {
                poem = ["It wasn't a hack.", "It was the habits.", "Of the person.", "Staring at this screen."];
            }

            let delay = 0;
            poem.forEach(line => {
                const p = document.createElement('h3');
                p.innerText = line;
                p.style.opacity = 0;
                p.style.transition = "opacity 2s";
                container.appendChild(p);
                
                setTimeout(() => { p.style.opacity = 1; }, delay);
                delay += 2000;
            });

            // The Uncomfortable Stare (Wait 40s total logic, shortened slightly for demo sanity, but keeps text)
            // Text remains VISIBLE during this wait.
            setTimeout(() => {
                launchAuction(scenario);
            }, delay + 8000); 
        }

        // --- PHASE 5: THE AUCTION (ENHANCED) ---
        function launchAuction(scenario) {
            screens.transition.classList.add('hidden'); // Text vanishes NOW
            screens.auction.classList.remove('hidden');
            screens.auction.style.animation = "screenOn 0.4s ease-out";

            const chatBox = document.getElementById('chat-box');
            const priceTag = document.getElementById('price-tag');
            let currentPrice = 0.00;
            const bidders = ["User992", "DataMines", "xX_Hunter_Xx", "Ghost", "Buyer77", "NullPtr"];
            
            // Build the insults list based on user's actual wrong answers
            let collectedInsults = [];
            state.answers.forEach((ans, idx) => {
                const q = questions[idx];
                // If answer matches the 'insecure' condition (or lack of secure condition)
                if ((q.insecure && ans) || (!q.insecure && !ans)) {
                    collectedInsults.push(q.insult);
                }
            });
            // Add generic insults if they were perfect
            if(collectedInsults.length === 0) {
                collectedInsults.push("Data is too clean. Suspicious.", "They are hiding something.", "I bet their hard drive is gold.");
            }

            // --- SCRIPT GENERATION ---
            let script = [];
            
            // 1. Intro
            if (state.camAllowed) {
                script.push({ role: 'bidder', text: "We have visual. Nice resolution." });
                script.push({ role: 'bidder', text: "Look at that face. They know." });
            } else {
                script.push({ role: 'bidder', text: "No cam? Boring." });
                script.push({ role: 'host', text: "Patience. The metadata is rich." });
            }

            script.push({ role: 'bidder', text: "Starting bid $0.10" });
            script.push({ role: 'bid', val: 0.10 });

            // 2. Loop through insults and host interruptions
            let insultIndex = 0;
            
            // INTERVENTION 1: Location
            script.push({ role: 'bidder', text: collectedInsults[insultIndex++] || "I want their search history." });
            script.push({ role: 'bidder', text: "Where are they?" });
            script.push({ role: 'host', text: `TRACE COMPLETE: Subject is in ${state.location}.` });
            script.push({ role: 'bidder', text: "That's local. Raising." });
            script.push({ role: 'bid', val: 0 });

            // INTERVENTION 2: Specific Habits
            script.push({ role: 'bidder', text: collectedInsults[insultIndex++] || "What about passwords?" });
            script.push({ role: 'bidder', text: collectedInsults[insultIndex++] || "They look nervous." });
            script.push({ role: 'bidder', text: "Raise." });
            script.push({ role: 'bid', val: 0 });

            // INTERVENTION 3: Device Fingerprint
            script.push({ role: 'bidder', text: "Is the data fresh?" });
            script.push({ role: 'host', text: `SYSTEM SCAN: ${state.device.substring(0, 25)}...` });
            script.push({ role: 'host', text: `BATTERY LEVEL: ${state.battery}. They are currently active.` });
            script.push({ role: 'bidder', text: "Active session? Take my money." });
            script.push({ role: 'bid', val: 0 }); // Big jump

            // Final Volley
            script.push({ role: 'bidder', text: collectedInsults[insultIndex++] || "Gimme everything." });
            script.push({ role: 'bidder', text: "Mine." });
            script.push({ role: 'bid', val: 0 });
            script.push({ role: 'bidder', text: "All in." });
            
            // Closing
            script.push({ role: 'host', text: "Going once..." });
            script.push({ role: 'host', text: "Going twice..." });
            script.push({ role: 'sold' });

            // --- EXECUTION LOOP ---
            let scriptIndex = 0;
            const interval = setInterval(() => {
                if (scriptIndex >= script.length) {
                    clearInterval(interval);
                    setTimeout(endSimulation, 4000);
                    return;
                }

                const item = script[scriptIndex];
                
                if (item.role === 'sold') {
                    document.getElementById('sold-stamp').style.opacity = 1;
                    document.getElementById('sold-stamp').style.transform = "translate(-50%, -50%) rotate(-15deg) scale(1.2)";
                    if(state.camAllowed) document.getElementById('webcam-feed').style.filter = "brightness(2) contrast(2)";
                } 
                else if (item.role === 'bid') {
                    // Logic: Price only goes up on bid
                    let inc = item.val > 0 ? item.val : (Math.random() * 3) + 1.5;
                    currentPrice += inc;
                    if(currentPrice > 14.8) currentPrice = 14.85; // cap near 15
                    priceTag.innerText = "$" + currentPrice.toFixed(2);
                    addChat(`>>> BID RAISED TO: $${currentPrice.toFixed(2)}`, "bid-msg");
                } 
                else {
                    let name = item.role === 'host' ? "HOST" : bidders[Math.floor(Math.random() * bidders.length)];
                    addChat(`${name}: ${item.text}`, item.role);
                }

                scriptIndex++;
                chatBox.scrollTop = chatBox.scrollHeight;
            }, 2800); // Slower pacing to allow reading
        }

        function addChat(text, type) {
            const d = document.createElement('div');
            d.className = `chat-msg ${type}`;
            d.innerText = text;
            document.getElementById('chat-box').appendChild(d);
        }

        function endSimulation() {
            screens.auction.classList.add('hidden');
            screens.outro.classList.remove('hidden');
            document.getElementById('final-price').innerText = document.getElementById('price-tag').innerText;
        }

    </script>
</body>
</html>
